import * as ts from 'typescript';
import { ITransformerConfig } from '../../../../transformer-config';
import { initTransformerConfig } from '../config';
import { CompilerOptionsProvider } from '../../../../compiler-options-provider/CompilerOptionsProvider';
import { runCompile } from '../../../internal/runCompile';
import { PathResolver } from '../../../internal/ts-helpers/path-resolver/PathResolver';

console.log(`
__/\\\\\\\\\\\\\\\\\\\\\\\\_____/\\\\\\\\\\\\\\\\\\\\\\______________________/\\\\\\\\\\\\\\\\\\_____/\\\\\\\\\\\\\\\\\\_____/\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\_        
 _\\/\\\\\\////////\\\\\\__\\/////\\\\\\///____________________/\\\\\\////////____/\\\\\\\\\\\\\\\\\\\\\\\\\\__\\///////\\\\\\/////__       
  _\\/\\\\\\______\\//\\\\\\_____\\/\\\\\\_____________________/\\\\\\/____________/\\\\\\/////////\\\\\\_______\\/\\\\\\_______      
   _\\/\\\\\\_______\\/\\\\\\_____\\/\\\\\\______/\\\\\\\\\\\\\\\\\\\\\\__/\\\\\\_____________\\/\\\\\\_______\\/\\\\\\_______\\/\\\\\\_______     
    _\\/\\\\\\_______\\/\\\\\\_____\\/\\\\\\_____\\///////////__\\/\\\\\\_____________\\/\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\_______\\/\\\\\\_______    
     _\\/\\\\\\_______\\/\\\\\\_____\\/\\\\\\___________________\\//\\\\\\____________\\/\\\\\\/////////\\\\\\_______\\/\\\\\\_______   
      _\\/\\\\\\_______/\\\\\\______\\/\\\\\\____________________\\///\\\\\\__________\\/\\\\\\_______\\/\\\\\\_______\\/\\\\\\_______  
       _\\/\\\\\\\\\\\\\\\\\\\\\\\\/____/\\\\\\\\\\\\\\\\\\\\\\__________________\\////\\\\\\\\\\\\\\\\\\_\\/\\\\\\_______\\/\\\\\\_______\\/\\\\\\_______ 
        _\\////////////_____\\///////////______________________\\/////////__\\///________\\///________\\///________
`);

export default (program: ts.Program, config?: ITransformerConfig): ts.TransformerFactory<ts.SourceFile> => {
    CompilerOptionsProvider.options = program.getCompilerOptions();
    initTransformerConfig(config);
    PathResolver.init();
    runCompile();

    return context => {
        return node => {
            return node;
        };
    };
};
